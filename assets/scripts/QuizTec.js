var questionBank = [
  //Q1
  {
    question: "Why We Use &lt;br&gt;Element",
    option: [
      "To Make Text Bold",
      "To Make Text Italic",
      "To Add Breakline",
      "To Create Horizontal Line",
    ],
    answer: "To Add Breakline",
  },
  //Q2
  {
    question: "Is &lt;img&gt; Element Has Attribute href",
    option: [
      "Yes",
      "No Its For Anchor Tag &lt;a&gt;",
      "All Elements Has This Attribute",
      "Answer 1 And 3 Is Right",
    ],
    answer: "No Its For Anchor Tag &lt;a&gt;",
  },
  //Q3
  {
    question: "How Can We Make Element Text Bold",
    option: [
      "Putting It Inside &it;b&gt;Tag",
      "Putting It Inside &lt;strong&gt; Tag",
      "Customizing It With Font-Weight Property In CSS",
      "All Answers Is Right",
    ],
    answer: "All Answers Is Right",
  },
  //Q4
  {
    question: "How Can We Include External Page Inside Our HTML Page",
    option: [
      "By Using Include in HTML",
      "By Using Load In HTML",
      "By Using iFrame Tag",
      "All Solutions Is Wrong",
    ],
    answer: "By Using iFrame Tag",
  },
  //Q4
  {
    question: "What Is The Tag That Not Exists in HTML",
    option: [
      "&lt; object &gt;",
      "&lt; basefont &gt;",
      "&lt; abbr &gt;",
      "All Tags Is Exists in HTML",
    ],
    answer: "All Tags Is Exists in HTML",
  },
  //Q5

  {
    question: "How We Specify Document Type Of HTML5 Page",
    option: [
      "&lt;!DOCTYPE html&gt;",
      "&lt;!DOCTYPE html5 &gt;",
      "&lt;!DOCTYPE html5&gt;",
      "&lt;!DOCTYPE html&gt;",
    ],
    answer: "&lt;!DOCTYPE html&gt;",
  },
  //Q6

  {
    question: "What Is The Element Thats Not Exists in HTML5 Semantics",
    option: [
      "&lt;article&gt;",
      "section&gt;",
      "&lt;blockquote&gt;",
      "&lt;aside &gt;",
    ],
    answer: "&lt;blockquote &gt;",
  },
  //Q7

  {
    question: "In HTML Can We Use This Way To Add Attributes",
    option: [
      "&lt;div class='class-name'&gt;",
      "&lt;div class=class-name&gt;",
      '&lt;div class="class-name"&gt;',
      "All Is Right",
    ],
    answer: "All Is Right",
  },
  //Q8
  {
    question: "What is CSS? ",
    option: [
      "CSS is a style sheet language",
      "CSS is designed to separate the presentation and content, including layout, colors, and fonts",
      "All of the mentioned",
      "CSS is the language used to style the HTML documents",
    ],
    answer: "All of the mentioned",
  },
  //Q9

  {
    question: "Which of the following tag is used to embed css in html page? ",
    option: [
      "&lt;css&gt;",
      "&lt;!DOCTYPE html&gt;",
      "&lt;script&gt;",
      " &lt;style&gt;",
    ],
    answer: "&lt;style&gt;",
  },
  //Q10

  {
    question:
      "Which of the following CSS selectors are used to specify a group of elements? ",
    option: ["tag", "id", "class", " both class and tag"],
    answer: "class",
  },
  //Q11
  {
    question:
      "Which of the following tags is used to define an HTML table?",
    option: ["&ltdiv&gt", "&lttable&gt", "&ltsection&gt", " &ltspan&gt"],
    answer: "&lttable&gt",
  },
  //Q12
  {
    question:
      "The CSS property used to set the text color is:",
    option: ["text-color", "color", "font-color", " text-style"],
    answer: "color",
  },
  //Q13
  {
    question:
      "Which HTML tag is used to link an external CSS file?",
    option: ["&ltstyle&gt", "&ltlink&gt", "&ltscript&gt", " &ltcss&gt"],
    answer: "&ltlink&gt",
  },
  //Q14
  {
    question:
      "The CSS property used to control the spacing between individual letters is:",
    option: ["letter-spacing", "word-spacing", "text-spacing", "line-spacing"],
    answer: "letter-spacing",
  },
  //Q15
  {
    question:
      "Which CSS property is used to add shadows to elements?",
    option: ["text-shadow", "box-shadow", "shadow-effect", "element-shadow"],
    answer: "box-shadow",
  },
  //Q16
  {
    question:
      "The HTML tag used to create an unordered list is: ",
    option: ["&ltol&gt", "&ltli&gt", "&ltul&gt", "&ltdl&gt"],
    answer: "&ltul&gt",
  },
  //Q17
  {
    question:
      "The HTML tag used to define a hyperlink is:",
    option: ["&lta&gt", "&ltlink&gt", "&lthref&gt", " &lturl&gt"],
    answer: "&lthref&gt",
  },
  //Q18
  {
    question:
      "The CSS property used to align text horizontally within its container is:",
    option: ["text-align", "vertical-align", "align-items", " justify-content"],
    answer: "text-align",
  },
  //Q19
  {
    question:
      "In CSS, the pseudo-class :hover is used to select elements when:",
    option: ["They are being clicked", "They are being focused", "The mouse pointer is over them",
     "They are the first child of their parent"],
    answer: "The mouse pointer is over them",
  },
  //Q20
  {
    question:
      "The HTML attribute used to specify an alternate text for an image is:",
    option: ["alt", "title", "src", " href"],
    answer: "alt",
  },
  //Q21
  {
    question:
      "Which CSS property is used to control the order of stacked elements in a container?",
    option: ["z-index", "order", "stack-order", "layer"],
    answer: "z-index",
  },
  //Q22
  {
    question:
      "The HTML tag used to define a line break is:",
    option: ["&ltbreak>", "&ltlb&gt", "&ltbr&gt", "&ltline&gt"],
    answer: "&ltbr&gt",
  },
  //Q23
  {
    question:
      "The CSS property used to set the background color of an element is:",
    option: ["background-color", "color", "bgcolor", " background"],
    answer: "background-color",
  },
  //Q24
  {
    question:
      "The HTML attribute used to specify the size of an input field is:",
    option: ["size", "length", "class", " both class and tag"],
    answer: "size",
  },
  //Q24
  {
    question:
      "Which of the following CSS selectors are used to specify a group of elements? ",
    option: ["tag", "id", "class", " both class and tag"],
    answer: "class",
  },
  //Q26
  {
    question:
      "Which of the following CSS selectors are used to specify a group of elements? ",
    option: ["tag", "id", "class", " both class and tag"],
    answer: "class",
  },
  //Q27
  {
    question:
      "Which of the following CSS selectors are used to specify a group of elements? ",
    option: ["tag", "id", "class", " both class and tag"],
    answer: "class",
  },
  //Q28
  {
    question:
      "Which of the following CSS selectors are used to specify a group of elements? ",
    option: ["tag", "id", "class", " both class and tag"],
    answer: "class",
  },
  //Q29
  {
    question:
      "Which of the following CSS selectors are used to specify a group of elements? ",
    option: ["tag", "id", "class", " both class and tag"],
    answer: "class",
  },
  //Q30
  {
    question:
      "Which of the following CSS selectors are used to specify a group of elements? ",
    option: ["tag", "id", "class", " both class and tag"],
    answer: "class",
  },
];
// console.log(questionBank.length);

var question = document.getElementById("question");
var quizContainer = document.getElementById("quiz-container");
var scorecard = document.getElementById("scoreboard");
var option0 = document.getElementById("optiona");
var option1 = document.getElementById("optionb");
var option2 = document.getElementById("optionc");
var option3 = document.getElementById("optiond");
var next = document.querySelector(".next");
var points = document.getElementById("score");

var span = document.querySelectorAll("label");
var i = 0;
var selectedAnswers = [];
var score = 0;
var savedQuestionIndex = localStorage.getItem("questionIndex");
var questionIndex = savedQuestionIndex ? parseInt(savedQuestionIndex) : 0;
var savedTime = localStorage.getItem("timer");
var timeInSecs = savedTime ? parseInt(savedTime) : 10 * 60; // Default to 10 minutes if no saved time exists
var ticker;

// Check if a saved question index exists in local storage
var savedQuestionIndex = localStorage.getItem('questionIndex');

if (savedQuestionIndex) {
  // Parse the saved index and assign it to the current index variable
  i = parseInt(savedQuestionIndex);
}
function shuffle(array) {
  for (let i = array.length - 1; i > 0; i--) {
    const j = Math.floor(Math.random() * (i + 1));
    [array[i], array[j]] = [array[j], array[i]];
  }
  return array;
}
 questionBank= shuffle(questionBank);
var questionCount = 0;

function startTimer(secs) {
  timeInSecs = parseInt(secs);
  ticker = setInterval(tick, 1000);
}

//function to display questions
function displayQuestion() {
  if (questionCount < 10) {
    question.innerHTML = questionCount + 1 + " " + questionBank[i].question;
    questionCount++;
  
  for (var a = 0; a < span.length; a++) {
    span[a].style.background = "none";
   
  }
  option0.innerHTML = questionBank[i].option[0];
  option1.innerHTML = questionBank[i].option[1];
  option2.innerHTML = questionBank[i].option[2];
  option3.innerHTML = questionBank[i].option[3];
  stat.innerHTML = "Question " + (questionCount ) + " of 10";}
  else{
    points.innerHTML = score + "/" +10;
    quizContainer.style.display = "none";
    scorecard.style.display = "block";
  }
  localStorage.setItem("timer", i.toString());
}

//function to calculate scores
function calcScore(e) {
  if (e.innerHTML === questionBank[i].answer && score < questionBank.length) {
    score = score + 1;
  }
  //setTimeout(nextQuestion);

  selectedAnswers[i] = e.innerHTML;
}

//function to display next question
function nextQuestion() {
  questionIndex++;

  if (i < questionBank.length - 1) {
    i = i + 1;


    displayQuestion();
    
  } else
   {
    points.innerHTML = score + "/" + 10;
    quizContainer.style.display = "none";
    scorecard.style.display = "block";
  
   } 
   localStorage.setItem('questionIndex', i.toString());

  localStorage.setItem("timer", i.toString());
}

//click events to next button
next.addEventListener("click", nextQuestion);

//Back to Quiz button event
function backToQuiz() {
  localStorage.removeItem("questionIndex");
  localStorage.removeItem("timer");
  //location.reload();
  window.location.href = "dashboard.html";
}

//function to check Answers
function checkAnswer() {
  var answerBank = document.getElementById("answerBank");
  var answers = document.getElementById("answers");
  answerBank.style.display = "block";
  scorecard.style.display = "none";
  for (var a = 0; a < questionBank.length; a++) {
    var list = document.createElement("li");
    list.innerHTML = questionBank[a].answer;
    answers.appendChild(list);
    showSelectedAnswers();
  }
}
function showSelectedAnswers() {
  var answerBank = document.getElementById("answerBank");
  var answers = document.getElementById("answers");
  answerBank.style.display = "block";
  scorecard.style.display = "none";
  answers.innerHTML = ""; // Clear the answers list

  for (var a = 0; a < questionCount ; a++) {
    if (selectedAnswers[a]) {
      var list = document.createElement("li");
      list.innerHTML = `  <div class="question bg-white p-5 border-bottom">
          <div class="d-flex flex-row align-items-center question-title">
              <h4 class="text custtext-danger tt">${questionBank[a].question}</h4>
            
          </div>
        
          <ul class="list-group list-group-flush">
          
          <li class="list-group-item  option"><span id="option1" ><b>Your Answer:</b> ${selectedAnswers[a]}</span></li>
          <li class="list-group-item option"><span id="option2"></span> <b>The correct answer:</b> ${questionBank[a].answer}</li>
    
         </ul>`;

      answers.appendChild(list);
    }
  }
}
let done=document.getElementById("score-btn")
  let array = JSON.parse(localStorage.getItem("users"));
  let currentUser = JSON.parse(localStorage.getItem("currentUser"));
  console.log("array-------")
  console.log(array)
  console.log("currentUser-------")
  console.log(currentUser)
  

 
  function updateInfo(){
  
         
          // currentUser.progressbar +=33;
       
          currentUser.techFlag = true;
       currentUser.techScore= score;
     console.log(score);
          //to add value of current user(before was: null)
          
      // }
      const updateArr = array.map((ele) => {
          return ele.email === currentUser.email
            ? {
                ...ele, //just update on key of the elements
                progressbar:currentUser.progressbar,
             
                techScore:currentUser.techScore,
                techFlag: true,
                
              }
            : ele;
        });
  
        localStorage.setItem("users", JSON.stringify(updateArr));
    
        localStorage.setItem("currentUser", JSON.stringify(currentUser));
  }
  done.addEventListener("click", updateInfo);

function startTimer(secs) {
  timeInSecs = parseInt(secs);
  ticker = setInterval(tick, 1000);
}
function tick() {
  var secs = timeInSecs;
  if (secs > 0) {
    timeInSecs--;
    localStorage.setItem("timer", timeInSecs.toString()); // Save the updated time in local storage
  } else {
    clearInterval(ticker);
    localStorage.removeItem("timer"); // Clear the timer from local storage when it reaches 0
    window.location.href = "dashboard.html";
    // Restart the timer with a duration of 10 minutes
  }

  var mins = Math.floor(secs / 60);
  secs %= 60;

  var result =
    (mins < 10 ? "0" : "") + mins + ":" + (secs < 10 ? "0" : "") + secs;

  document.getElementById("countdown").innerHTML = "Timer: " + result;
}

startTimer(timeInSecs); // 5 minutes in seconds

displayQuestion();